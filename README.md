# zkApp with O1js

This repository contains the implementation of a zero-knowledge application (zkApp) using the O1js JavaScript library. It demonstrates the setup, deployment, and testing of a zkApp on a Mina blockchain instance, along with guidelines for extending its functionality.

---

## Overview
zkApps are decentralized applications that leverage zero-knowledge proofs to ensure data privacy and efficiency. Using O1js, developers can easily build zkApps and integrate advanced cryptographic proofs into their blockchain projects. This repository provides:

1. A step-by-step guide to setting up a zkApp project.
2. Code for deploying and testing the zkApp on a local Mina blockchain instance.
3. Examples of extending the zkApp with additional functionality.

---

## Folder Structure

```plaintext
my-zkapp/
├── index.js         # Deployment and testing script
├── zkapp.js         # Core zkApp logic
├── package.json     # Project metadata and dependencies
└── node_modules/    # Installed dependencies (auto-generated by npm)
```

---

## Prerequisites

- **Node.js and npm**: Install from [nodejs.org](https://nodejs.org/).
  ```bash
  node -v
  npm -v
  ```

- **O1js**: Install using npm:
  ```bash
  npm install o1js
  ```

- Basic knowledge of JavaScript (ES6) and an IDE like Visual Studio Code.


## Setup Instructions

1. **Create the Project Directory**:
   ```bash
   mkdir my-zkapp
   cd my-zkapp
   ```

2. **Initialize the Project**:
   ```bash
   npm init -y
   ```

3. **Install Dependencies**:
   ```bash
   npm install o1js
   ```

4. **Create Files**:
   Set up the following structure:
   ```plaintext
   my-zkapp/
   ├── index.js
   ├── zkapp.js
   └── package.json
   ```

---

## Code Overview

### Core zkApp Logic (`zkapp.js`)
Defines the zkApp with state management and update functionality:

```javascript
const { Field, PrivateKey, PublicKey, Proof, SmartContract } = require('o1js');

class MyZkApp extends SmartContract {
  // Define a state variable
  state = this.state(Field);

  // Constructor to initialize state
  constructor(address) {
    super(address);
    this.state.set(Field(0)); // Initialize state to zero
  }

  // Method to update the state securely
  updateState(newValue) {
    this.state.assertEquals(Field(0)); // Ensure state is as expected
    this.state.set(newValue); // Update state with the new value
  }
}

module.exports = MyZkApp;
```

### Deployment Script (`index.js`)
Handles deployment and testing of the zkApp:

```javascript
const { Mina, PrivateKey, PublicKey } = require('o1js');
const MyZkApp = require('./zkapp');

(async () => {
  // Initialize the Mina blockchain
  Mina.setActiveInstance(Mina.LocalBlockchain());

  // Generate keys for deployment
  const deployerKey = PrivateKey.random();
  const zkAppKey = PrivateKey.random();
  const zkAppAddress = PublicKey.fromPrivateKey(zkAppKey);

  // Deploy the zkApp
  const zkApp = new MyZkApp(zkAppAddress);
  const txn = await Mina.transaction(deployerKey, () => {
    zkApp.deploy({ zkAppKey });
  });

  await txn.send();
  console.log('zkApp deployed at:', zkAppAddress.toBase58());

  // Test the zkApp logic
  const testTxn = await Mina.transaction(deployerKey, () => {
    zkApp.updateState(Field(42));
  });

  await testTxn.send();
  console.log('State updated to:', zkApp.state.get().toString());
})();
```

---

## Running the zkApp

1. **Install Dependencies**:
   ```bash
   npm install
   ```

2. **Run the Script**:
   ```bash
   node index.js
   ```

3. **Expected Output**:
   - The address where the zkApp is deployed:
     ```
     zkApp deployed at: B62...
     ```
   - Confirmation of state update:
     ```
     State updated to: 42
     ```

---

## Extending the zkApp

### Add Validation Rules
Secure the state update logic with signature validation:

```javascript
updateState(newValue, signature) {
  const isValid = this.verifySignature(signature);
  if (!isValid) {
    throw new Error('Unauthorized update attempt');
  }
  this.state.set(newValue);
}
```

### Emit Events
Track state changes by emitting events:

```javascript
emitEvent('StateUpdated', { previousState: this.state.get(), newState: newValue });
```

### Multi-state Variables
Expand functionality to handle multiple state variables:

```javascript
class ExtendedZkApp extends SmartContract {
  state1 = this.state(Field);
  state2 = this.state(Field);

  updateStates(newValue1, newValue2) {
    this.state1.set(newValue1);
    this.state2.set(newValue2);
  }
}
```

---

## Deploying to a Live Mina Network

1. **Set up a Mina wallet**:
   - Follow the [Mina Wallet Setup Guide](https://minaprotocol.com/).

2. **Connect to the Mina Network**:
   Replace `Mina.LocalBlockchain()` with:
   ```javascript
   Mina.Network({ url: '<node-url>' });
   ```

3. **Fund the Deployer Account**:
   - Use Mina faucets or transfers to fund the deployer key.

4. **Deploy the zkApp**:
   - Run the deployment script as before.

---

## Best Practices

- **Security First**: Validate inputs and signatures to prevent unauthorized actions.
- **Modular Design**: Break down functionality into smaller, reusable modules.
- **Test Extensively**: Use automated tests to ensure correctness.
- **Stay Updated**: Monitor O1js and Mina Protocol updates for new features and fixes.

---

## Conclusion

This project demonstrates how to:

1. Set up and deploy a zkApp using O1js.
2. Write and test zkApp logic.
3. Extend functionality with advanced features.
4. Deploy to a live Mina blockchain.

Explore further to integrate zkApps into decentralized ecosystems or experiment with advanced cryptographic features.
